{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% translate "My Blog" %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <style>
      body { background-color: #f8f9fa; }
      .page-header { background-color: white; border-bottom: 1px solid #dee2e6; }
    </style>
  </head>
  <body>
    <div class="page-header">
      <div class="container py-3 d-flex justify-content-between align-items-center">
        <div>
            {% block page_header %}
            {# Le titre et le sous-titre de la page, définis dans les templates enfants #}
            {% endblock %}
        </div>
        <div>
            {# Sélecteur de langue simple #}
            {% get_current_language as CURRENT_LANG %}
            {% get_available_languages as AVAILABLE_LANGS %}
            <form action="{% url 'set_language' %}" method="post" class="d-inline">
                {% csrf_token %}
                <input name="next" type="hidden" value="{{ request.path }}">
                {% for lang_code, lang_name in AVAILABLE_LANGS %}
                    {% if lang_code != CURRENT_LANG %}
                        <button type="submit" name="language" value="{{ lang_code }}" class="btn btn-link btn-sm">
                            {% if lang_code == 'fr' %}{% translate "Passer en français" %}{% else %}{% translate "Switch to English" %}{% endif %}
                        </button>
                    {% endif %}
                {% endfor %}
            </form>
        </div>
      </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="#"><i class="bi bi-files text-white"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'articles-list' %}active{% endif %}" href="{% url 'blog:articles-list' %}">{% translate "Articles" %}</a>
            </li>
            {% if user.is_authenticated %}
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'favourite-article-list' %}active{% endif %}" href="{% url 'blog:favourite-article-list' %}">{% translate "Favourites" %}</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'publication-list' %}active{% endif %}" href="{% url 'blog:publication-list' %}">{% translate "Publications" %}</a>
            </li>
            {% else %}
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'register' %}active{% endif %}" href="{% url 'blog:register' %}">{% translate "Register" %}</a>
            </li>
            {% endif %}
          </ul>
          <div class="d-flex">
            {% if user.is_authenticated %}
            <span class="navbar-text me-3">{% translate "Logged as" %} {{ user.username }}</span>
            <form class="d-inline" method="post" action="{% url 'blog:logout' %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-outline-light btn-sm">{% translate "Logout" %}</button>
            </form>
            {% else %}
            <form class="d-flex" method="post" action="{% url 'blog:login' %}">
              {% csrf_token %}
              <input
                class="form-control form-control-sm me-2"
                type="text"
                name="username"
                placeholder="{% translate 'Username' %}"
                required />
              <input
                class="form-control form-control-sm me-2"
                type="password"
                name="password"
                placeholder="{% translate 'Password' %}"
                required />
              <button class="btn btn-light btn-sm" type="submit">{% translate "Login" %}</button>
            </form>
            {% endif %}
          </div>
        </div>
      </div>
    </nav>

    <main class="container mt-5">
      {% if messages %} {% for message in messages %}
      <div class="alert alert-success" role="alert">{{ message }}</div>
      {% endfor %} {% endif %} {% block content %} {% endblock %}
    </main>

    <footer class="mt-5 py-4 bg-dark text-white-50">
      <div class="container text-center">
        <small>{% translate "D07 piscine Django by hgandar - &copy; 2025" %}</small>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>

